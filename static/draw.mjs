import{Coord as s,cellCoordToCornerCord as D,cornerCoordToCellCoord as F,containsCoord as I,height as r,width as n,cellSize as f,horzMargin as c,vertMargin as u,valueToCoord as C,NORTH as e,SOUTH as w,WEST as a,EAST as h}from"./grid.mjs";import"./lights_enum.mjs";import{BLOCK as T,TRACK as O}from"./trains_enum.mjs";function P(){return{size:f,horzMargin:c,vertMargin:u,height:r,width:n}}function R(e,i){return{x:i.horzMargin+i.size*e.col,y:i.vertMargin+i.size*e.row}}function W(e,i){return{x:i.horzMargin+i.size*(e.col+.5),y:i.vertMargin+i.size*(e.row+.5)}}function Q(e,i){for(var t=P(i.length,i[0].length),o=0;o<i.length;o++)for(var l,r,n,a=0;a<i[0].length;a++)i[o][a]&&(n=r=l=void 0,l=e,r=t,n=R(n=s(o,a),r),l.fillStyle="black",l.fillRect(n.x,n.y,r.size,r.size))}function _(e,i,t){for(var o,l=P(i.length,i[0].length),r=0;r<i.length;r++)for(var n,a,h,z,f=0;f<i[0].length;f++)""!=i[r][f]&&("number"==typeof i[r][f]?U(e,l,i[r][f],s(r,f),"white"):(z=h=a=n=void 0,n=e,a=l,h=parseInt(i[r][f]),z=s(r,f),n.fillStyle="white",n.textAlign="center",n.textBaseline="middle",n.font=Math.floor(2*a.size/3)+"px Arial",z=W(z,a),n.fillText(h,z.x,z.y)));for(o of t)Z(e,o,l)}function U(e,i,t,o,l){var o=W(o,i),l=(e.strokeStyle=l,e.lineWidth=3,e.lineCap="round",+i.size/3),i=+i.size/6,r=o.x+l*Math.cos(t),n=o.y-l*Math.sin(t),a=o.x+l*Math.cos(t+Math.PI),o=o.y-l*Math.sin(t+Math.PI),l=r+i*Math.cos(t+3*Math.PI/4),s=n-i*Math.sin(t+3*Math.PI/4),h=r+i*Math.cos(t-3*Math.PI/4),i=n-i*Math.sin(t-3*Math.PI/4);e.beginPath(),e.moveTo(a,o),e.lineTo(r,n),e.moveTo(r,n),e.lineTo(l,s),e.moveTo(r,n),e.lineTo(h,i),e.stroke()}function V(e,i,t,o,l){e.fillStyle=l,e.textAlign="center",e.textBaseline="middle",e.font=Math.floor(i.size)+"px Arial";l=W(t,i);e.fillText(o,l.x,l.y)}function X(e,i,t,o){for(var l=P(i.length,i[0].length),r=0;r<t.length;r++)for(var n,a=0;a<t[0].length;a++)t[r][a]&&(e.fillStyle="yellow",n=R(s(r,a),l),e.fillRect(n.x,n.y,l.size,l.size));for(var h,r=0;r<i.length;r++)for(a=0;a<i[0].length;a++){var z,f,y,x=s(r,a);1==i[r][a]?(f=z=y=void 0,y=e,f=R(f=x,z=l),y.fillStyle="black",y.fillRect(f.x+2*z.size/5,f.y+2*z.size/5,z.size/5,z.size/5)):2==i[r][a]&&(y=void 0,y=W(y=x,l),$(e,l,y))}for(h of o)Z(e,h,l)}function he(e,i,t,o,l,r,n){o=o||0,l=l||i,r=r||0,n=n||t;var a=P();e.strokeStyle="#444444",e.lineWidth=3,e.lineCap="square",e.beginPath();for(var s=o;s<l+1;s++){var h=a.horzMargin+s*a.size;e.moveTo(h,a.vertMargin+o*a.size),e.lineTo(h,a.height-a.vertMargin-a.size*(i-l))}e.stroke(),e.beginPath();for(s=r;s<n+1;s++){h=a.vertMargin+s*a.size;e.moveTo(a.horzMargin+r*a.size,h),e.lineTo(a.width-a.horzMargin-a.size*(t-n),h)}e.stroke()}function ze(e,i){var t,o=P();for(t of i){var l=C(t),r=W(l,o),n=o.size/2.2,a=o.size/Math.SQRT2,n=e.createRadialGradient(r.x,r.y,n,r.x,r.y,a),r=(n.addColorStop(0,"rgba(100%,100%,100%,0)"),n.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=n,R(l,o));e.fillRect(r.x,r.y,o.size,o.size)}}function fe(e,i){for(var t=P(i.length,i[0].length),o=0;o<i.length;o++)for(var l=0;l<i[0].length;l++){b=d=v=c=g=x=y=r=f=z=h=a=n=void 0;var r,n=e,a=s(o,l),h=i[o][l],z=t,f=[];for(r of h)f.push(r);f.sort();var y=f.length;if(0!=y)for(var x=2*Math.PI/y,g=Math.PI/4,c=W(a,z),v=R(a,z),d=0;d<y;d++){n.lineWidth=1,n.fillStyle=(e=>{switch(e){case 0:return"rgba(100%,100%,100%,0)";case 1:return"rgba(80%,20%,20%,0.5)";case 2:return"rgba(20%,80%,20%,0.5)";case 3:return"rgba(20%,20%,80%,0.5)";case 4:return"rgba(80%,80%,20%,0.5)";case 5:return"rgba(80%,20%,80%,0.5)";case 6:return"rgba(20%,80%,80%,0.5)"}return"rgba(100%,100%,100%,0)"})(f[d]),n.beginPath(),n.moveTo(c.x,c.y);var b=Y(d*x,z);for(n.lineTo(v.x+b.x,v.y+b.y);g<(d+1)*x;){b=Y(g,z);n.lineTo(v.x+b.x,v.y+b.y),g+=Math.PI/2}b=Y((d+1)*x,z),n.lineTo(v.x+b.x,v.y+b.y),n.lineTo(c.x,c.y),n.fill()}}}function Y(e,i){var t,o=0,l=0;return Math.PI/4<e&&e<=3*Math.PI/4?(l=0,t=Math.PI/2-e,o=i.size/2+Math.tan(t)*i.size/2):3*Math.PI/4<e&&e<=5*Math.PI/4?(o=0,t=e-Math.PI,l=i.size/2+Math.tan(t)*i.size/2):5*Math.PI/4<e&&e<=7*Math.PI/4?(l=i.size,t=e-3*Math.PI/2,o=i.size/2+Math.tan(t)*i.size/2):(o=i.size,l=i.size/2-Math.tan(e)*i.size/2),{x:o,y:l}}function ye(e,i,t){var o=P(i.length,i[0].length);null!==t&&Z(e,t,o);for(var l,r,n,a,h=0;h<i.length;h++)for(var z=0;z<i[0].length;z++)if(0!=i[h][z])if(i[h][z]<0)l=e,r=s(h,z),a=void 0,r=W(r,n=o),l.lineCap="round",l.lineWidth=9,l.strokeStyle="black",l.beginPath(),a=.375*n.size,l.moveTo(r.x-a,r.y-a),l.lineTo(r.x+a,r.y+a),l.moveTo(r.x-a,r.y),l.lineTo(r.x+a,r.y),l.moveTo(r.x-a,r.y+a),l.lineTo(r.x+a,r.y-a),l.moveTo(r.x,r.y-a),l.lineTo(r.x,r.y+a),l.stroke(),l.beginPath(),l.arc(r.x,r.y,.25*n.size,0,2*Math.PI,!1),l.stroke();else{var f="black";switch(i[h][z]){case 1:f="blue";break;case 2:f="green";break;case 3:f="red";break;case 4:f="purple";break;case 5:f="brown"}V(e,o,s(h,z),i[h][z],f)}}function Z(e,i,t){var o=W(i,t),l=t.size/3,r=t.size/Math.SQRT2,l=e.createRadialGradient(o.x,o.y,l,o.x,o.y,r),o=(l.addColorStop(0,"rgba(100%,100%,100%,0)"),l.addColorStop(1,"rgba(100%,0%,0%,1)"),e.fillStyle=l,R(i,t));e.fillRect(o.x,o.y,t.size,t.size)}function xe(e,i){for(var t=P(i.length,i[0].length),o=0;o<i.length;o++)for(var l,r=0;r<i[0].length;r++)2!=i[o][r]&&(e.fillStyle="#888888",l=R(s(o,r),t),e.fillRect(l.x,l.y,t.size,t.size))}function ge(e,i,t){var o,l,r,n=P(t.length,t[0].length);for(o of i)2!=t[o.row][o.col]&&(l=W(o,n),e.strokeStyle="#22CC22",e.lineWidth=9,e.beginPath(),r=.3*n.size,e.arc(l.x,l.y,r,0,2*Math.PI,!1),e.stroke())}function ce(e,i){for(var t,o,l,r,n,a,h,z=P(i.length,i[0].length),f=0;f<i.length;f++)for(var y=0;y<i[0].length;y++)1==i[f][y]&&(t=e,o=new s(f,y),h=a=n=r=l=void 0,o=R(o,z),l=o.y+.25*z.size,r=o.y+.5*z.size,n=o.y+.75*z.size,a=o.x+.33*z.size,h=o.x+.67*z.size,o=o.y+.375*z.size,t.lineWidth=1,t.fillStyle="red",t.beginPath(),t.moveTo(a,l),t.lineTo(h,o),t.lineTo(a,r),t.fill(),t.lineWidth=5,t.lineCap="round",t.strokeStyle="brown",t.beginPath(),t.moveTo(a,l),t.lineTo(a,n),t.stroke())}function ve(e,i,t,o){var l,r=P();for(l of i)Z(e,l,r)}function de(e,i){for(var t=P(i.length,i[0].length),o=0;o<i.length;o++)for(var l,r=0;r<i[0].length;r++)i[o][r]&&(l=W(s(Math.floor(o/2),Math.floor(r/2)),t),o%2==0&&(l.y-=t.size/2),r%2==0&&(l.x-=t.size/2),$(e,t,l))}function $(e,i,t){i=3*i.size/8;e.fillStyle="white",e.beginPath(),e.arc(t.x,t.y,i,0,2*Math.PI),e.fill(),e.beginPath(),e.strokeStyle="black",e.lineWidth=3,e.arc(t.x,t.y,i,0,2*Math.PI),e.stroke()}function be(e,i){for(var t=P(i.length,i[0].length),o=0;o<i.length;o++)for(var l,r=0;r<i[0].length;r++)i[o][r]&&(l=R(s(o,r),t),e.fillStyle="#DDDDDD",e.fillRect(l.x,l.y,t.size,t.size))}function ue(i,t){for(var o=P(t.length,t[0].length),l=0;l<t.length;l++)for(var r=0;r<t[0].length;r++){var n=R(s(l,r),o);i.strokeStyle="black",i.lineWidth=5,i.lineCap="round",i.beginPath(),0<(t[l][r]&e)&&(i.moveTo(n.x,n.y),i.lineTo(n.x+o.size,n.y)),0<(t[l][r]&h)&&(i.moveTo(n.x+o.size,n.y),i.lineTo(n.x+o.size,n.y+o.size)),0<(t[l][r]&w)&&(i.moveTo(n.x,n.y+o.size),i.lineTo(n.x+o.size,n.y+o.size)),0<(t[l][r]&a)&&(i.moveTo(n.x,n.y),i.lineTo(n.x,n.y+o.size)),i.stroke()}}function Me(e,i,t,o){var l,r=P();for(l of i)U(e,r,l.dir,l.coord,"black")}function Te(e,i,t,o){for(var l of i){z=n=r=h=s=a=void 0;var r,n,a=e,s=l,h=P();a.strokeStyle="#FF88CC",a.lineWidth=3,a.lineCap="square",a.setLineDash([.1*h.size,.1*h.size]),a.beginPath();for([r,n]of s.cells){var z=R(r,h);n[0]&&ee(a,h,z,!1,n[1],n[3],.1),n[1]&&ee(a,h,z,!0,n[0],n[2],.1),n[2]&&ee(a,h,z,!1,n[1],n[3],.9),n[3]&&ee(a,h,z,!0,n[0],n[2],.9)}a.stroke(),a.fillStyle="#FF88CC",a.textAlign="left",a.textBaseline="top",a.font=Math.floor(.3*h.size)+"px Arial",z=R(s.upperLeft,h),a.fillText(s.sum,z.x+.125*h.size,z.y+.125*h.size),a.setLineDash([])}}function ee(e,i,t,o,l,r,n){n=i.size*n+(o?t.y:t.x),l=(o?t.x:t.y)+(l?.1*i.size:.1*-i.size),t=(o?t.x:t.y)+(r?.9*i.size:1.1*i.size);o?(e.moveTo(l,n),e.lineTo(t,n)):(e.moveTo(n,l),e.lineTo(n,t))}function Se(e,i){var t,o=[];for(t of[[0,-1],[-1,0],[0,1],[1,0]]){var l=s(e.row+t[0],e.col+t[1]);o.push(!I(i,l))}return o}function pe(e,i,t,o){var l,r=P();for(l of i){b=d=v=g=x=c=u=y=f=z=h=s=a=n=void 0;for(var n=e,a=r,s=l,h=3*a.size/8,z=null,f=null,y=0;y<s.length;y++){var x,g,c,v,d,b,u=W(f=s[y],a);0==y?$(n,a,u):(c=W(z,a),1==y&&(x=Math.atan2(u.x-c.x,u.y-c.y),c={x:c.x+h*Math.sin(x),y:c.y+h*Math.cos(x)}),y==s.length-1&&(x=Math.atan2(u.x-c.x,u.y-c.y),g=.25*a.size,u={x:u.x-g*Math.sin(x),y:u.y-g*Math.cos(x)}),n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(u.x,u.y),n.stroke(),y==s.length-1&&(x=Math.atan2(u.x-c.x,u.y-c.y),g=.25*a.size,c=u.x+g*Math.sin(x+3*Math.PI/4),v=u.y+g*Math.cos(x+3*Math.PI/4),d=u.x+g*Math.sin(x-3*Math.PI/4),b=u.y+g*Math.cos(x-3*Math.PI/4),n.beginPath(),n.moveTo(c,v),n.lineTo(u.x,u.y),n.lineTo(d,b),n.stroke())),z=f}}}function Pe(e,i){for(var t=P(i.length,i[0].length),o=0;o<i.length;o++)for(var l=0;l<i[0].length;l++){var r=i[o][l],n=s(o,l);0<r.final?V(e,t,n,r.final,"#222288"):(ie(e,t,n,r.inner),te(e,t,n,r.outer))}}function ie(e,i,t,o){e.fillStyle="#222288",e.textAlign="center",e.textBaseline="middle",e.font=Math.floor(.25*i.size)+"px Arial";var t=W(t,i),l=[];for(r of o)l.push(r);l.sort();var r,n="";for(r of l)n+=r;e.fillText(n,t.x,t.y)}function te(e,i,t,o){if(0!=o.size){var l,r=Math.ceil(o.size/2),n=[];for(l of o)n.push(l);n.sort(),e.fillStyle="#222288",e.textAlign="center",e.textBaseline="middle",e.font=Math.floor(.25*i.size)+"px Arial";for(var a=R(t,i),s=a.y+.15*i.size,h=0;h<r;h++){var z=Math.max(r-1,1),f=a.x+i.size*(.15+.7/z*h);e.fillText(n[h],f,s)}for(s=a.y+.85*i.size,h=r;h<n.length;h++){z=Math.max(r-1,1),f=a.x+i.size*(.15+.7/z*(h-r));e.fillText(n[h],f,s)}}}function ke(e,i,t,o){for(var l=P(i.length,i[0].length),r=3;r<i.length-3;r+=2)for(var n=3;n<i[0].length-3;n+=2){var a=s((r-1)/2,(n-1)/2);t[r-2][n-2]==O?oe(e,l,a,"#AAAAAA",o):t[r-2][n-2]==T?se(e,l,R(a,l),"black"):i[r][n]==O?oe(e,l,a,"#DDDDDD",o):i[r][n]==T&&se(e,l,R(a,l),"brown")}}function me(e,i){for(var t=2+(i.body.length-1)/2,o=2+(i.body[0].length-1)/2,l=P(),r=0;r<i.north.length;r++)0<i.north[r]&&V(e,l,s(0,r+1),i.north[r],"black");for(r=0;r<i.south.length;r++)0<i.south[r]&&V(e,l,s(t-1,r+1),i.south[r],"black");for(r=0;r<i.west.length;r++)0<i.west[r]&&V(e,l,s(r+1,0),i.west[r],"black");for(r=0;r<i.east.length;r++)0<i.east[r]&&V(e,l,s(r+1,o-1),i.east[r],"black")}function we(e,i,t){for(var o=P(i.length,i[0].length),l=2;l<i.length-2;l++)if(l%2==0)for(var r=3;r<i[0].length-2;r+=2){var n=R(s(l/2,(r-1)/2),o);t[l-2][r-2]==O?le(e,o,n,"brown"):t[l-2][r-2]==T?(n.y-=o.size/2,se(e,o,n,"black")):i[l][r]==O?le(e,o,n,"brown"):i[l][r]==T&&(n.y-=o.size/2,se(e,o,n,"brown"))}else for(r=2;r<i[0].length-2;r+=2){n=R(s((l-1)/2,r/2),o);t[l-2][r-2]==O?re(e,o,n,"brown"):t[l-2][r-2]==T?(n.x-=o.size/2,se(e,o,n,"black")):i[l][r]==O?re(e,o,n,"brown"):i[l][r]==T&&(n.x-=o.size/2,se(e,o,n,"brown"))}}function oe(e,i,t,o,l){var r,n,a,s,h=R(t,i);e.fillStyle=o,e.fillRect(h.x,h.y,i.size,i.size),l[(t=D(t)).row-1][t.col]==O?l[t.row][t.col+1]==O?ne(e,i,r={x:h.x+7*i.size/8,y:h.y+i.size/8},Math.PI,"brown"):l[t.row+1][t.col]==O?(o=i,a=h,s="brown",(n=e).strokeStyle=s,n.lineWidth=7,n.lineCap="square",n.beginPath(),n.moveTo(a.x+o.size/4,a.y),n.lineTo(a.x+o.size/4,a.y+o.size),n.moveTo(a.x+3*o.size/4,a.y),n.lineTo(a.x+3*o.size/4,a.y+o.size),n.stroke()):l[t.row][t.col-1]==O&&(r={x:h.x+i.size/8,y:h.y+i.size/8},ne(e,i,r,Math.PI/2,"brown")):l[t.row][t.col+1]==O?l[t.row+1][t.col]==O?(r={x:h.x+7*i.size/8,y:h.y+7*i.size/8},ne(e,i,r,3*Math.PI/2,"brown")):l[t.row][t.col-1]==O&&(s=i,a=h,o="brown",(n=e).strokeStyle=o,n.lineWidth=7,n.lineCap="square",n.beginPath(),n.moveTo(a.x,a.y+s.size/4),n.lineTo(a.x+s.size,a.y+s.size/4),n.moveTo(a.x,a.y+3*s.size/4),n.lineTo(a.x+s.size,a.y+3*s.size/4),n.stroke()):l[t.row+1][t.col]==O&&l[t.row][t.col-1]==O&&(r={x:h.x+i.size/8,y:h.y+7*i.size/8},ne(e,i,r,0,"brown"))}function le(e,i,t,o){e.strokeStyle=o,e.lineWidth=7,e.lineCap="square",e.beginPath(),e.moveTo(t.x+i.size/4,t.y-i.size/8),e.lineTo(t.x+i.size/4,t.y+i.size/8),e.moveTo(t.x+3*i.size/4,t.y-i.size/8),e.lineTo(t.x+3*i.size/4,t.y+i.size/8),e.stroke()}function re(e,i,t,o){e.strokeStyle=o,e.lineWidth=7,e.lineCap="square",e.beginPath(),e.moveTo(t.x-i.size/8,t.y+i.size/4),e.lineTo(t.x+i.size/8,t.y+i.size/4),e.moveTo(t.x-i.size/8,t.y+3*i.size/4),e.lineTo(t.x+i.size/8,t.y+3*i.size/4),e.stroke()}function ne(e,i,t,o,l){e.strokeStyle=l,e.lineWidth=7,e.lineCap="square",ae(e,t,i.size/8,o),ae(e,t,5*i.size/8,o)}function ae(e,i,t,o){e.beginPath(),e.arc(i.x,i.y,t,o,o-Math.PI/2,!0),e.stroke()}function se(e,i,t,o){e.strokeStyle=o,e.lineWidth=3,e.lineCap="round",e.beginPath(),e.moveTo(t.x+i.size/3,t.y+i.size/3),e.lineTo(t.x+2*i.size/3,t.y+2*i.size/3),e.moveTo(t.x+2*i.size/3,t.y+i.size/3),e.lineTo(t.x+i.size/3,t.y+2*i.size/3),e.stroke()}function Ce(e,i,t,o){var l,r=P();for(l of i){var n,a,s,h,z=C(l);z.row%2==1&&z.col%2==1?(h=W(z=F(z),r),a=r.size/4,s=3*Math.SQRT2*r.size/8,(h=e.createRadialGradient(h.x,h.y,a,h.x,h.y,s)).addColorStop(0,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,n=R(z,r),e.fillRect(n.x+r.size/8,n.y+r.size/8,3*r.size/4,3*r.size/4)):z.row%2==1&&z.col%2==0?(n=R(z=F(z),r),a=.1*r.size/8,s=Math.SQRT2*r.size/8,(h=e.createRadialGradient(n.x,n.y+r.size/4,a,n.x,n.y+r.size/4,s)).addColorStop(0,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,e.fillRect(n.x-r.size/8,n.y+r.size/8,r.size/4,r.size/8),(h=e.createLinearGradient(n.x-s,n.y,n.x+s,n.y)).addColorStop(0,"rgba(0%,50%,100%,1)"),h.addColorStop(.5,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,e.fillRect(n.x-r.size/8,n.y+r.size/4,r.size/4,r.size/2),(h=e.createRadialGradient(n.x,n.y+3*r.size/4,a,n.x,n.y+3*r.size/4,s)).addColorStop(0,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,e.fillRect(n.x-r.size/8,n.y+3*r.size/4,r.size/4,r.size/8)):z.row%2==0&&z.col%2==1&&(n=R(z=F(z),r),a=.1*r.size/8,s=Math.SQRT2*r.size/8,(h=e.createRadialGradient(n.x+r.size/4,n.y,a,n.x+r.size/4,n.y,s)).addColorStop(0,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,e.fillRect(n.x+r.size/8,n.y-r.size/8,r.size/8,r.size/4),(h=e.createLinearGradient(n.x,n.y-s,n.x,n.y+s)).addColorStop(0,"rgba(0%,50%,100%,1)"),h.addColorStop(.5,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,e.fillRect(n.x+r.size/4,n.y-r.size/8,r.size/2,r.size/4),(h=e.createRadialGradient(n.x+3*r.size/4,n.y,a,n.x+3*r.size/4,n.y,s)).addColorStop(0,"rgba(100%,100%,100%,0)"),h.addColorStop(1,"rgba(0%,50%,100%,1)"),e.fillStyle=h,e.fillRect(n.x+3*r.size/4,n.y-r.size/8,r.size/8,r.size/4))}}export{Q as drawLightWalls,_ as drawLightClues,X as drawLightsInput,he as drawGrid,ze as drawSelected,fe as drawColors,ye as drawMineClues,xe as drawFog,ge as drawSpecialClues,ce as drawMineInput,ve as drawErrors,de as drawCenters,be as drawValid,ue as drawLines,Me as drawGalaxyArrows,Te as drawCages,Se as cageCell,pe as drawSudokuArrows,Pe as drawSudokuDigits,ie as drawSudokuInners,te as drawSudokuOuters,ke as drawTrackCells,me as drawEdgeClues,we as drawTrackEdges,Ce as drawCornerSelected};